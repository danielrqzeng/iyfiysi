// gen by iyfiysi at {{ .CreateTime.Format "2006 Jan 02" }}


package {{.PackageName}}

import (
    "google.golang.org/grpc"
    "github.com/spf13/viper"
    "{{.Domain}}/{{.AppName}}/internal/pkg/db"
    "{{.Domain}}/{{.AppName}}/proto"
)

{{- range $Service := .ServicesList}}
type {{$Service.ServiceName}}Impl struct{}
{{end}}

func DoRegister(grpcServer *grpc.Server) (err error) {
{{range $Service := .ServicesList}}
	//{
		s := &{{$Service.ServiceName}}Impl{}
    	proto.Register{{$Service.ServiceName}}Server(grpcServer, s)
	//}
{{end}}

    instance := viper.GetString("server.listen")
    serviceKey := viper.GetString("etcd.registerKey")
    db.Register(serviceKey,instance)
    return
}